# devvmiller-docker-apache-newrelic-node-awscli

[![Build Status](https://travis-ci.com/GabLeRoux/devvmiller-docker-apache-newrelic-node-awscli.svg?branch=master)](https://travis-ci.com/GabLeRoux/devvmiller-docker-apache-newrelic-node-awscli)
[![Docker Stars](https://img.shields.io/docker/stars/gableroux/devvmiller-docker-apache-newrelic-node-awscli.svg)](https://hub.docker.com/r/gableroux/devvmiller-docker-apache-newrelic-node-awscli)
[![Docker Pulls](https://img.shields.io/docker/pulls/gableroux/devvmiller-docker-apache-newrelic-node-awscli.svg)](https://hub.docker.com/r/gableroux/devvmiller-docker-apache-newrelic-node-awscli)
[![Image](https://images.microbadger.com/badges/image/gableroux/devvmiller-docker-apache-newrelic-node-awscli.svg)](https://microbadger.com/images/gableroux/devvmiller-docker-apache-newrelic-node-awscli)
[![Version](https://images.microbadger.com/badges/version/gableroux/devvmiller-docker-apache-newrelic-node-awscli.svg)](https://microbadger.com/images/gableroux/devvmiller-docker-apache-newrelic-node-awscli)
[![Layers](https://images.microbadger.com/badges/image/gableroux/devvmiller-docker-apache-newrelic-node-awscli.svg)](https://microbadger.com/images/gableroux/devvmiller-docker-apache-newrelic-node-awscli)

This adds nodejs and a few command lines to [PHP image devvmiller/docker-apache-newrelic](https://github.com/devvmiller/docker-apache-newrelic). This is an image used in a CI.

* docker
* nodejs
* yarn
* npm
* composer
* python3
* aws
* ssh

## How this image was generated

See [`generate-image.sh`](generate-image.sh), then diff the two images to show custom changes. Docker command line was taken from `circleci-images/shared/images/Dockerfile-basic.template`

```bash
diff CircleCi.Dockerfile Dockerfile
```

```diff
1,7c1
< ###
< ### DO NOT MODIFY THIS FILE.  THIS FILE HAS BEEN AUTOGENERATED
< ###
< 
< ###
< ### DO NOT MODIFY THIS FILE.  THIS FILE HAS BEEN AUTOGENERATED
< ###
---
> FROM devvmiller/docker-apache-newrelic:latest
9c3,64
< FROM circleci/php:7.2.9-cli-stretch
---
> ENV XDEBUG_VERSION 2.6.0
> 
> RUN pecl install xdebug-$XDEBUG_VERSION && docker-php-ext-enable xdebug
> 
> ## Install awscli, gpg and git command line
> RUN apt-get update && \
>     apt-get install -y \
>         python3 \
>         python3-pip \
>         python3-setuptools \
>         groff \
>         less \
>         gnupg2 \
>         ssh \
>         curl \
>     && pip3 --no-cache-dir install --upgrade awscli \
>     && apt-get clean
> 
> # install jq
> RUN JQ_URL="https://circle-downloads.s3.amazonaws.com/circleci-images/cache/linux-amd64/jq-latest" \
>   && curl --silent --show-error --location --fail --retry 3 --output /usr/bin/jq $JQ_URL \
>   && chmod +x /usr/bin/jq \
>   && jq --version
> 
> # Install Docker
> 
> # Docker.com returns the URL of the latest binary when you hit a directory listing
> # We curl this URL and `grep` the version out.
> # The output looks like this:
> 
> #>    # To install, run the following commands as root:
> #>    curl -fsSLO https://download.docker.com/linux/static/stable/x86_64/docker-17.05.0-ce.tgz && tar --strip-components=1 -xvzf docker-17.05.0-ce.tgz -C /usr/local/bin
> #>
> #>    # Then start docker in daemon mode:
> #>    /usr/local/bin/dockerd
> 
> RUN set -ex \
>   && export DOCKER_VERSION=$(curl --silent --fail --retry 3 https://download.docker.com/linux/static/stable/x86_64/ | grep -o -e 'docker-[.0-9]*-ce\.tgz' | sort -r | head -n 1) \
>   && DOCKER_URL="https://download.docker.com/linux/static/stable/x86_64/${DOCKER_VERSION}" \
>   && echo Docker URL: $DOCKER_URL \
>   && curl --silent --show-error --location --fail --retry 3 --output /tmp/docker.tgz "${DOCKER_URL}" \
>   && ls -lha /tmp/docker.tgz \
>   && tar -xz -C /tmp -f /tmp/docker.tgz \
>   && mv /tmp/docker/* /usr/bin \
>   && rm -rf /tmp/docker /tmp/docker.tgz \
>   && which docker \
>   && (docker version || true)
> 
> # docker compose
> RUN COMPOSE_URL="https://circle-downloads.s3.amazonaws.com/circleci-images/cache/linux-amd64/docker-compose-latest" \
>   && curl --silent --show-error --location --fail --retry 3 --output /usr/bin/docker-compose $COMPOSE_URL \
>   && chmod +x /usr/bin/docker-compose \
>   && docker-compose version
> 
> # install dockerize
> RUN DOCKERIZE_URL="https://circle-downloads.s3.amazonaws.com/circleci-images/cache/linux-amd64/dockerize-latest.tar.gz" \
>   && curl --silent --show-error --location --fail --retry 3 --output /tmp/dockerize-linux-amd64.tar.gz $DOCKERIZE_URL \
>   && tar -C /usr/local/bin -xzvf /tmp/dockerize-linux-amd64.tar.gz \
>   && rm -rf /tmp/dockerize-linux-amd64.tar.gz \
>   && dockerize --version
> 
> COPY --from=composer:latest /usr/bin/composer /usr/bin/composer
78,79c133,141
< 
< USER circleci
---
> RUN yarn --version
> RUN npm --version
> RUN php --version
> RUN composer --version
> RUN python3 --version
> RUN aws --version
> RUN openssl version
> RUN jq --version
> RUN curl --version
```